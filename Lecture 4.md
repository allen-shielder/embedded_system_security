第一部分：密码学基础（Cryptography Fundamentals）

| 分类      | 内容                                                                            |
| ------- | ----------------------------------------------------------------------------- |
| 📌 目标   | 机密性（Confidentiality）、完整性（Integrity）、认证（Authentication）、不可否认性（Non-repudiation） |
| 📌 应用场景 | 电子交易、隐私保护、防止未授权访问、认证文档等                                                       |

对称加密（Symmetric Encryption）

|类型|描述|示例|
|---|---|---|
|分组加密 Block Cipher|每次加密固定长度的数据块|DES、IDEA、AES|
|流加密 Stream Cipher|每次加密一个比特或一个字节|RC4、Salsa20、Grain|
|关键点|加密与解密用的是**同一个密钥** ➜ 密钥必须保密||

公钥加密（Asymmetric Encryption）

|原理|使用一对密钥：公钥加密、私钥解密。|
|---|---|
|应用|数字签名、密钥交换、认证|
|核心算法类型|RSA（因数分解）、Diffie-Hellman/DSA（离散对数）、ECC（椭圆曲线）|
|RSA 算法流程（加密）|C = P^e mod N|
|RSA 解密流程|P = C^d mod N|

第二部分：ECC（Elliptic Curve Cryptography）


| ECC 特点 | 描述                           |
| ------ | ---------------------------- |
| 原理     | 利用椭圆曲线上的点运算进行加密              |
| 优点     | 在相同安全等级下，密钥更短 ➜ 更快、能耗更低、占用更小 |
| 应用     | 比特币签名、TLS加密、数字签名等            |
| 算术基础   | 点加法、多次加法构成乘法，单位元为“无穷远点”或“零点” |


## RSA 的基本原理（大白话讲解）：

### 🔑 **核心思想：一个钥匙锁上，另一个钥匙才能打开**

- 每个人有一对钥匙：
    
    - **公钥**（公开给别人）：用于加密
        
    - **私钥**（自己保管）：用于解密


|操作|用到的钥匙|公式|描述|
|---|---|---|---|
|加密 Encrypt|公钥 `(e, n)`|`C = P^e mod n`|把明文 P 加密成密文 C|
|解密 Decrypt|私钥 `(d, n)`|`P = C^d mod n`|把密文 C 解密回明文 P|
|数字签名 Sign|私钥 `(d, n)`|`S = H^d mod n`（H 是哈希）|生成数字签名 S|
|验证 Verify|公钥 `(e, n)`|`H = S^e mod n`（比对哈希值）|用公钥验证签名是否正确|
优点与缺点：

|优点|缺点|
|---|---|
|不需要共享密钥|加解密速度比对称加密慢|
|支持签名验证|密钥长度大，占带宽、资源消耗高|
|适合身份认证/密钥交换|不适合大数据量加密传输（一般与 AES 搭配）|





第三部分：混合加密系统（Mixed Cryptography）

|场景|描述|
|---|---|
|密钥交换 + 数据加密|公钥算法用于认证、建立密钥；对称加密用于通信 ➜ 性能 + 安全兼顾|
|举例|TLS 通信：ECDHE 建立密钥、AES 加密数据|



第四部分：完整性 + 认证机制

|类型|描述|示例|
|---|---|---|
|哈希 Hash|输入 → 固定长度摘要，不可逆，用于完整性校验|SHA-1, SHA-256|
|MAC|密钥 + 哈希，验证消息未被篡改，消息来源可信|HMAC-SHA256|
|数字签名|哈希摘要 → 私钥加密 ➜ 用公钥验证，防篡改、防抵赖|RSA签名、ECDSA签名|



第五部分：嵌入式系统中的密码学挑战


|挑战|说明|
|---|---|
|资源有限|处理器弱、存储小 ➜ 需轻量加密算法|
|设计目标|安全启动（Secure Boot）、多播认证、密钥管理|



RSA vs ECC 对比（128-bit 安全等级）

|项目|RSA|ECC|
|---|---|---|
|安全性|需要 15360-bit 密钥|只需 512-bit|
|性能|慢（签名生成）|快（尤其是私钥操作）|
|带宽|公钥/签名大、私钥更大|占用小、节省空间|
|总结|未来倾向 ECC，效率高|ECC 更适合嵌入式设备|


第六部分：可信计算基础（Trusted Computing）



|组成模块|类型|功能说明|
|---|---|---|
|I/O 接口|硬件|与主机通信|
|Non-Volatile 存储|硬件|保存密钥、配置信息、Endorsement Key、AIK、策略等|
|RSA 引擎|加密引擎|实现 RSA 签名、加解密（通常 2048-bit）|
|SHA-1 引擎|哈希引擎|执行哈希摘要计算（如 PCR 值）|
|RNG（随机数生成器）|加密引擎|生成随机密钥、非对等认证用数|
|PCR（平台配置寄存器）|寄存器|存储系统状态度量，用于安全启动/远程认证|
|**Program Code**|固件/逻辑|TPM 内部的控制程序，**驱动指令解析与安全策略执行**|
|**RSA Key Generation**|控制逻辑|负责安全地产生 RSA 密钥对（Endorsement Key, AIK 等）|
|**Opt-In / Opt-Out**|管理逻辑|控制 TPM 是否启用 ➜ 需用户授权后 TPM 才可使用，有“用户参与”的安全控制机制|























