## 一、嵌入式系统中操作系统的角色

- **防止未授权访问**
    
- 提供高等级安全认证（如 MILS）
    
- 安全优先，而不是事后加固
    
- Root权限被滥用将导致信息外泄
    
- OS需处理不断出现的新漏洞
    

---

## 📌 二、嵌入式操作系统类型与特点

### 普通OS vs 实时OS（RTOS）

| 特性   | 普通OS           | 实时操作系统 RTOS                   |
| ---- | -------------- | ----------------------------- |
| 关键因素 | 功能完备，非时间敏感     | **时间敏感，实时性保障**                |
| 示例   | Linux, Windows | **FreeRTOS, VxWorks, Zephyr** |
| 使用场景 | 桌面应用、普通控制系统    | 气囊控制、核电站、导弹、车载系统等 **硬实时系统**   |
| 调度机制 | 轮转调度等，可能延迟响应   | 确保关键任务优先、不可延误                 |
| 响应特性 | 延迟容忍           | **需在规定时间内完成任务（WCET）**         |

---

## 📌 三、RTOS 核心功能（考点！）

| 功能             | 说明                                   |
| -------------- | ------------------------------------ |
| 任务管理           | 管理任务生命周期：创建、等待、运行、终止                 |
| 调度（Scheduling） | 调度算法：**轮转、优先级、时钟驱动**，满足实时需求          |
| 资源分配           | 限制资源使用，采用**抢占机制**，防止低优先级占用关键资源       |
| 中断处理           | 外部事件打断CPU，**执行中断服务程序 ISR**，再恢复现场继续执行 |

---

## 📌 四、内核类型（Kernel Types）

| 类型      | 特点与代表                                        |
| ------- | -------------------------------------------- |
| **微内核** | 模块化、最小化，仅实现基本功能；更易于维护与安全，代表：**QNX, VxWorks** |
| **宏内核** | 所有服务集成进内核；性能强但安全风险高，代表：**FreeRTOS, Linux**   |
|         |                                              |

---

## 📌 五、RTOS 安全核心需求（Core OS Security）

| 安全机制       | 说明                                            |
| ---------- | --------------------------------------------- |
| **内存保护**   | 任务间物理隔离，防止越界访问                                |
| **虚拟内存**   | 地址转换与隐藏，防物理地址被反查                              |
| **故障恢复**   | 软件看门狗、容错机制、防止系统因错误崩溃                          |
| **资源配额**   | 关键资源分区，避免 DoS 攻击                              |
| **虚拟驱动程序** | 驱动隔离，防止 buffer overflow 漏洞污染整个内核              |
| **确定性执行**  | 系统必须有**最坏执行时间 WCET** 保障时间片隔离                  |
| **安全调度**   | Partition-based Scheduling，确保关键任务有保障的 CPU 时间片 |

---

## 📌 六、MILS 安全模型（重点！！）

| 安全策略       | 含义                             |
| ---------- | ------------------------------ |
| **信息流控制**  | 禁止任务间未授权数据传输                   |
| **数据隔离**   | 各任务数据互不访问                      |
| **损害限制**   | 某个任务崩溃，不影响其他任务                 |
| **时间分区处理** | 不同任务间共享缓冲区、寄存器时通过“清理”和时间隔离避免泄露 |

---

## 📌 七、分离内核（Separation Kernel）

- 提供高安全保证的参考监控器
    
- 三大特性：
    
    1. **Always Invoked**（所有访问都被内核检查）
        
    2. **Tamper-proof**（无法被篡改）
        
    3. **Evaluable**（可验证评估）
        

---

## 📌 八、访问控制与能力机制（ACL + Capabilities）

|分类|含义与特点|
|---|---|
|DAC|用户定义访问规则；灵活但不够强|
|MAC|系统强制执行规则，不允许用户修改|
|Capability|类似钥匙，持有才可访问；用于微内核操作系统，IPC Endpoint常是关键能力|

- **推荐组合使用 DAC + MAC**，既有灵活性又有强隔离
    

---

## 📌 九、典型攻击与防御示例

|攻击点|示例/机制|防御机制|
|---|---|---|
|**资源耗尽**|fork bomb 生成无数进程|每个隔离域独立资源配额，防止滥用|
|**驱动漏洞**|buffer overflow 注入代码至内核|虚拟驱动隔离机制|
|**非确定性攻击**|系统调用时间差异引起的**侧信道攻击**|强化内核 WCET、检测 covert channel|
|**Confused Deputy**|客户滥用服务权限（越权写入敏感区）|对象+权限绑定 tuple；禁止隐式委托权限传递|

---

## 📌 十、系统虚拟化与远程管理（Virtualization + Remote）

|功能|举例与说明|
|---|---|
|嵌入式虚拟化|嵌入式 Hypervisor 支持多个操作系统运行，如 QEMU、Xen|
|安全威胁|蓝色药丸攻击（Blue Pill）、SubVirt、Xen漏洞|
|远程管理与风险|支持远程打补丁（如火星探测器 Pathfinder 修复），但也可能被远程注入恶意代码|
|对策|使用签名认证程序、防篡改机制、TPM + 安全引导 Secure Boot 实现可信启动|

---

## 📌 十一、TCB 信任基础保障（Trusted Computing Base）

- **安全启动（Secure Boot）**：防止恶意固件加载
    
- **远程证明（Remote Attestation）**：远程设备身份验证
    
- **可信硬件供应链保障**：确保芯片制造无后门
